# Filtro de mediana

Ao analisar as características do sinal medido na ausência de movimento, é possível observar a presença de alguns picos, tanto positivos quanto negativos, cuja amplitude chega a 160 mV e a duração é menor que 1 ms, o que aponta para a possibilidade de um erro de conversão pelo microcontrolador [citation needed]. Como tais picos atrapalham o controle, buscou-se implementar um filtro que pudesse removê-los. Após experimentar com um modelo simples de filtro de resposta infinita (IIR), descrito pela equação \filtro_iir, na qual $ŷ_t$ representa a nova estimativa da posição, $ŷ_{t-1}$ representa a estimativa anterior e $y_t$ representa a medição realizada. Nesse filtro, a variável $\alpha$ é um valor entre 0 e 1 que controla o comportamento do filtro, sendo que um valor mais próximo de 1 rejeita as variações da medição e um valor mais próximo de 0 as acompanha.

$$ŷ_t = ŷ_{t-1} \alpha + y_t (1 - \alpha)$$

Uma alternativa mais específica para retirar os picos do sinal é o filtro de medianas. Nesse filtro, a estimativa é dado pelo número central das últimas N amostras. Um buffer circular é responsável por armazenar essas amostras na sequência, substituindo a amostra mais antiga a cada nova leitura, e, a cada iteração do filtro, as amostras são reordenadas e o valor na posição central é selecionado. Diferente dos filtros IIR e FIR, nos quais todas as amostras influenciam o resultado do filtro, o filtro de mediana consegue rejeitar completamente os valores outliers. Esse comportamento dá ao filtro uma característica não-linear, que em algumas situações não é desejável. Além disso, por realizar a ordenação dos elementos, apresenta uma complexidade computacional superior aos outros filtros, mas levando-se em consideração o pequeno tamanho da janela de amostragem utilizada, de 5 elementos, a complexidade computacional não afetou negativamente a performance do sistema. É possível observar na Figura \filtro que o filtro de medianas consegue rejeitar o ruído, apresentando uma variação muito menor no sinal se comparado ao sinal bruto, em verde, e ao sinal vermelho, que representa o filtro IIR citado anteriormente.
